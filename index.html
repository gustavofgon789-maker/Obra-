<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Obrahh√≠ | Aluguel de Ferramentas</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
  <style>
  :root {
    --verde-escuro: #145c43;
    --verde-claro: #e8f5e9; /* Verde bem suave de fundo */
    --branco: #ffffff;
  }

  body {
    background-color: #f4f7f6; /* Fundo geral da p√°gina */
    margin: 0;
    font-family: 'Inter', sans-serif;
  }

  /* Cabe√ßalho com a Logo preenchendo */
  .header-container {
    background-color: var(--verde-claro);
    padding: 40px 20px 60px 20px;
    text-align: center;
    border-bottom-left-radius: 40px;
    border-bottom-right-radius: 40px;
  }

  .logo-tipo {
    font-size: 48px;
    font-weight: 800;
    color: var(--verde-escuro);
    letter-spacing: -2px;
    margin: 0;
    text-transform: lowercase; /* Estilo startup */
  }

  .logo-tipo span {
    color: #2e7d32; /* Um detalhe em verde levemente diferente */
  }

  /* Barra de pesquisa que sobrep√µe o verde */
  .search-box {
    max-width: 90%;
    margin: -30px auto 20px;
    background: var(--branco);
    padding: 10px 20px;
    border-radius: 15px;
    box-shadow: 0 10px 20px rgba(0,0,0,0.08);
    display: flex;
    align-items: center;
  }

  .search-box input {
    border: none;
    width: 100%;
    padding: 12px;
    font-size: 16px;
    outline: none;
  }
</style>

<header class="header-container">
  <h1 class="logo-tipo">obrah<span>h√≠</span></h1>
  <p style="color: var(--verde-escuro); opacity: 0.8; margin-top: 5px; font-weight: 500;">
    Aluguel de ferramentas sem burocracia
  </p>
</header>

<div class="search-box">
  <input type="text" placeholder="O que voc√™ precisa hoje?">
</div>


  <div class="filter-wrapper">
    <div class="filter-bar">
      <button class="filter-btn active" onclick="filtrar('Todas', this)">Todas</button>
      <button class="filter-btn" onclick="filtrar('Eletricas', this)">El√©tricas</button>
      <button class="filter-btn" onclick="filtrar('Jardinagem', this)">Jardinagem</button>
      <button class="filter-btn" onclick="filtrar('Construcao', this)">Constru√ß√£o</button>
      <button class="filter-btn" onclick="filtrar('Pintura', this)">Pintura</button>
    </div>
  </div>
</div>

<div class="container" id="listaAnuncios">
  </div>

<div class="app-footer">
  <a href="index.html" class="footer-item active">
    <div style="font-size: 20px;">üè†</div>
    <div style="font-size: 10px; font-weight: bold;">In√≠cio</div>
  </a>

  <a href="anunciar.html" class="footer-center-btn">
    +
  </a>

  <a href="login.html" class="footer-item">
  <div style="font-size: 20px;">üë§</div>
  <div style="font-size: 10px; font-weight: bold;">Perfil</div>
</a>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBLvvoNS4VF2Y0rOh-dHj3GFiwao1D4KYU",
  authDomain: "obrai-56278.firebaseapp.com",
  projectId: "obrai-56278",
  storageBucket: "obrai-56278.firebasestorage.app",
  messagingSenderId: "735990959965",
  appId: "1:735990959965:web:d28f6cbc7b85abfd48e2b4"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const lista = document.getElementById("listaAnuncios");

import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

const auth = getAuth(app);

// Monitor de Login para mudar o visual do bot√£o Perfil
onAuthStateChanged(auth, (user) => {
  const perfilLink = document.querySelector('a[href="login.html"]');
  if (user) {
    // Se estiver logado, mostra a foto do Google ou a inicial do nome
    perfilLink.innerHTML = `
      <img src="${user.photoURL}" style="width:25px; border-radius:50%; border: 2px solid var(--primary);">
      <div style="font-size: 10px; font-weight: bold; color: var(--primary);">Ol√°, ${user.displayName.split(' ')[0]}</div>
    `;
    perfilLink.href = "perfil.html"; // Evita voltar para a tela de login se j√° est√° logado
  }
});
  
  
async function carregarAnuncios(filtro = "Todas") {
  lista.innerHTML = "<p style='grid-column: 1/-1; text-align:center;'>Buscando ferramentas...</p>";
  
  try {
    const q = query(collection(db, "anuncios"), orderBy("dataCriacao", "desc"));
    const querySnapshot = await getDocs(q);
    lista.innerHTML = "";

    querySnapshot.forEach((doc) => {
      const anuncio = doc.data();

      if (filtro !== "Todas" && anuncio.categoria !== filtro) return;

      const card = document.createElement("div");
      card.className = "card";
            card.innerHTML = `
        <a href="detalhes.html?id=${doc.id}" style="text-decoration: none; color: inherit;">
          <img src="${anuncio.imagem || 'https://via.placeholder.com/300x300?text=Obrahhi'}" class="card-img">
          <div class="card-content">
            <h3 class="card-title">${anuncio.nome}</h3>
            <div class="card-price">R$ ${anuncio.preco} / dia</div>
          </div>
        </a>
        <div style="padding: 0 12px 12px 12px;">
          <a href="https://wa.me/55${anuncio.whatsapp}" target="_blank" class="btn-card-wa">
            Reservar
          </a>
        </div>
      `;

      lista.appendChild(card);
    });

    if (lista.innerHTML === "") {
      lista.innerHTML = "<p style='grid-column: 1/-1; text-align:center;'>Nenhuma ferramenta encontrada.</p>";
    }

  } catch (e) {
    console.error(e);
    lista.innerHTML = "<p style='grid-column: 1/-1; text-align:center;'>Erro ao carregar os an√∫ncios.</p>";
  }
}

// Busca Instant√¢nea
document.getElementById("inputBusca").addEventListener("input", (e) => {
  const termo = e.target.value.toLowerCase();
  const cards = document.querySelectorAll(".card");
  cards.forEach(card => {
    const texto = card.innerText.toLowerCase();
    card.style.display = texto.includes(termo) ? "flex" : "none";
  });
});

window.filtrar = (categoria, btn) => {
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  carregarAnuncios(categoria);
};

carregarAnuncios();
</script>

</body>
</html>
